<button
  id="theme-toggle"
  class="inline-flex items-center gap-2 rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm hover:bg-gray-50 dark:border-neutral-700 dark:bg-neutral-800 dark:hover:bg-neutral-700"
  aria-label="Toggle theme"
>
  <span class="i">ðŸŒ“</span>
  <span>ä¸»é¢˜</span>
</button>

<script>
  (function () {
    const root = document.documentElement;
    const saved = localStorage.getItem("theme");
    const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;

    function apply(theme) {
      if (theme === "dark" || (theme === "system" && prefersDark)) {
        root.classList.add("dark");
      } else {
        root.classList.remove("dark");
      }
    }

    apply(saved ?? "system");

    const mq = window.matchMedia("(prefers-color-scheme: dark)");
    mq.addEventListener?.("change", () => {
      const current = localStorage.getItem("theme") ?? "system";
      if (current === "system") apply("system");
    });

    document.getElementById("theme-toggle")?.addEventListener("click", () => {
      const current = localStorage.getItem("theme") ?? "system";
      const next = current === "light" ? "dark" : current === "dark" ? "system" : "light";
      localStorage.setItem("theme", next);
      apply(next);
      document.getElementById("theme-toggle").ariaLabel = `Theme: ${next}`;
    });
  })();
</script>
